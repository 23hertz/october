// Moved logic into appropriate locations now